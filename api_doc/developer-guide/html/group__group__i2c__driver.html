<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Astra SRSDK Peripheral Driver Library: I2C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="syna_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Astra SRSDK Peripheral Driver Library
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__group__i2c__driver.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Topics</a>  </div>
  <div class="headertitle"><div class="title">I2C<div class="ingroups"><a class="el" href="group__api__ref.html">Driver API Reference</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Topics</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i2c__enums.html">Enumerated Types</a></td></tr>
<tr class="memdesc:group__group__i2c__enums"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated types for I2C driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i2c__data__structures.html">Data Structures</a></td></tr>
<tr class="memdesc:group__group__i2c__data__structures"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structures for I2C driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i2c__functions.html">General Functions</a></td></tr>
<tr class="memdesc:group__group__i2c__functions"><td class="mdescLeft">&#160;</td><td class="mdescRight">General functions for I2C driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The I²C driver provides a high-level, easy-to-use API for configuring and operating the I²C hardware block on Synaptics MCUs It supports both Controller (formerly “Master”) and Target (formerly “Slave”) roles, in blocking and non-blocking modes, with full control over timing, addressing, and error handling.</p>
<h1><a class="anchor" id="group_i2c_features"></a>
Key Features</h1>
<ul>
<li>Controller &amp; Target roles</li>
<li>7-bit &amp; 10-bit addressing, General-Call support</li>
<li>Standard (100 kHz), Fast (400 kHz), Fast-Plus (1 MHz)</li>
<li>Automatic bus-recovery on stuck SDA</li>
<li>Comprehensive interrupt control in the driver</li>
<li>Blocking and interrupt-driven transfer APIs with user callbacks</li>
<li>Detailed status and error reporting, including TX_ABRT source flags</li>
</ul>
<h1><a class="anchor" id="group_i2c_api_organization"></a>
API Organization</h1>
<ul>
<li>Initialization / Deinitialization<ul>
<li><a class="el" href="group__group__i2c__functions.html#gafa780f958ffc89e4ef9bfd7da518059f">i2c_init()</a>, <a class="el" href="group__group__i2c__functions.html#gac01ec22ec99431acce599a0aabb22ba2">i2c_deinit()</a></li>
</ul>
</li>
<li>Role Configuration<ul>
<li><a class="el" href="group__group__i2c__functions.html#ga56acdbac2ce9645a29d8308abb523b88">i2c_controller_set_config()</a></li>
</ul>
</li>
<li>Transfer<ul>
<li>Blocking: <a class="el" href="group__group__i2c__functions.html#ga1cb4ad53c8fd34aeb943efe1ddc19721">i2c_controller_write_blocking()</a>,<a class="el" href="group__group__i2c__functions.html#gaf5f0d3928229604eaa1ab381ed6f8faf">i2c_controller_read_blocking()</a></li>
<li>Non-blocking: <a class="el" href="group__group__i2c__functions.html#ga929619923229235b0bf639948b8bd681">i2c_controller_write_non_blocking()</a>, <a class="el" href="group__group__i2c__functions.html#ga5c9d1d9c1671efeb077d79b674eab2eb">i2c_controller_read_non_blocking()</a> <a class="el" href="group__group__i2c__functions.html#gae73fbf0d36d67dd67255e23bfb208d2b">i2c_target_prep_controller_write()</a>,<a class="el" href="group__group__i2c__functions.html#gaa5350754e4fe5eb93eafd1543bd3ff37">i2c_target_prep_controller_read()</a></li>
<li>Abort: <a class="el" href="group__group__i2c__functions.html#ga90177796f5c44c331deed2d211b4de3b">i2c_controller_abort()</a>,<a class="el" href="group__group__i2c__functions.html#ga31b904d8cda40ca0367b985e5bad2bbb">i2c_target_abort()</a></li>
</ul>
</li>
<li>Control Operations<ul>
<li><a class="el" href="group__group__i2c__functions.html#gace91592121b91b49a96b29e309a342bc">i2c_enable()</a>, <a class="el" href="group__group__i2c__functions.html#ga9fb6bba7a3c26b9f5370148bbc871d8e">i2c_disable()</a></li>
</ul>
</li>
<li>Status &amp; Error Handling<ul>
<li><a class="el" href="group__group__i2c__functions.html#ga0cf906879224578d59b84ed9feba9c72">i2c_register_callback()</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="group_i2c_usage"></a>
Typical Usage</h1>
<ol type="1">
<li>Configure the I2C-related pins using the pinmux driver (e.g., set SDA/SCL to I2C function).</li>
<li>Call <a class="el" href="group__group__i2c__functions.html#gafa780f958ffc89e4ef9bfd7da518059f">i2c_init()</a> to reset the block and enable its clock.</li>
<li>Configure timing and addressing via <a class="el" href="group__group__i2c__functions.html#ga56acdbac2ce9645a29d8308abb523b88">i2c_controller_set_config()</a>, <a class="el" href="group__group__i2c__functions.html#gac99a88fb18f525aa58281681c7f8e0fc">i2c_target_set_config()</a></li>
<li>Register a callback for non-blocking transfers.</li>
<li>Enable the I²C block with <a class="el" href="group__group__i2c__functions.html#gace91592121b91b49a96b29e309a342bc">i2c_enable()</a>.</li>
<li>Perform transfers via blocking or non-blocking APIs.</li>
<li>When finished, disable the block via <a class="el" href="group__group__i2c__functions.html#ga9fb6bba7a3c26b9f5370148bbc871d8e">i2c_disable()</a> and call <a class="el" href="group__group__i2c__functions.html#gac01ec22ec99431acce599a0aabb22ba2">i2c_deinit()</a>.</li>
</ol>
<h2><a class="anchor" id="i2c_init"></a>
I2C Initialization and Pinmux Configuration</h2>
<p>This snippet handles the initialization of I2C modules (Controller 0, Controller 1, and Target) and configures the corresponding pinmux settings based on enabled configuration macros. </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gafa780f958ffc89e4ef9bfd7da518059f">i2c_init</a>(I2C_INST_M);</div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gafa780f958ffc89e4ef9bfd7da518059f">i2c_init</a>(I2C_INST_S);</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_enable"></a>
I2C Enable</h2>
<p>This snippet enables the required I2C controllers and targets after pinmux configuration. </p><div class="fragment"><div class="line"><span class="comment">/* Enable interfaces */</span></div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gace91592121b91b49a96b29e309a342bc">i2c_enable</a>(I2C_INST_M);</div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gace91592121b91b49a96b29e309a342bc">i2c_enable</a>(I2C_INST_S);</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_controller_set_config"></a>
Controller Configuration</h2>
<p>This snippet shows how to define a structure to configure the I2C controller. </p><div class="fragment"><div class="line"><span class="comment">/* Controller Configuration */</span></div>
<div class="line"><a class="code hl_struct" href="structi2c__controller__config__t.html">i2c_controller_config_t</a> i2c_con_config = {</div>
<div class="line">    .ten_bit_addr          = <span class="keyword">false</span>,</div>
<div class="line">    .speed                 = <a class="code hl_enumvalue" href="group__group__i2c__enums.html#ggabd2e2f94f77a40346fd9b1fe93a472afa8dc6cae939d20d56a78d123365caa4ca">I2C_SPEED_FAST</a>,</div>
<div class="line">    .enable_bus_clear      = <span class="keyword">false</span>,</div>
<div class="line">    .clear_stuck_sda       = <span class="keyword">false</span>,</div>
<div class="line">    .scl_stuck_timeout_ms  = 1,</div>
<div class="line">    .sda_stuck_timeout_ms  = 1</div>
<div class="line">};</div>
<div class="line"> </div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_target_set_config"></a>
Target Configuration</h2>
<p>This snippet demonstrates how to define a structure for configuring the I2C target. </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structi2c__target__config__t.html">i2c_target_config_t</a> i2c_t_config = {</div>
<div class="line">    .ten_bit_addr          = <span class="keyword">false</span>,</div>
<div class="line">    .speed                 = <a class="code hl_enumvalue" href="group__group__i2c__enums.html#ggabd2e2f94f77a40346fd9b1fe93a472afa8dc6cae939d20d56a78d123365caa4ca">I2C_SPEED_FAST</a>,</div>
<div class="line">    .target_address        = I2C_TARGET_ADDRESS,</div>
<div class="line">    .general_call_response = <span class="keyword">false</span>,</div>
<div class="line">    .scl_stuck_timeout_ms  = 1,</div>
<div class="line">    .sda_stuck_timeout_ms  = 1</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_controller_set_target_address"></a>
Setting Target Address</h2>
<p>This snippet demonstrates how to set and retrieve the I2C controller's target address. </p><div class="fragment"><div class="line">    <span class="comment">/* Set target addresses */</span></div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gaf9699f1ff7d14ae2b159cc15b11667ef">i2c_controller_set_target_address</a>(I2C_INST_M, I2C_TARGET_ADDRESS);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__group__i2c__functions.html#ga539712b80040d06be99dacef7282c795">i2c_controller_get_target_address</a>(I2C_INST_M, &amp;address) == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga6e3f0ba22df18c81e1d0962060940979aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller target address: 0x%02X\n&quot;</span>, address);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Failed to get I2C target address\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_block"></a>
Blocking Controller Write and Read</h2>
<p>This snippet shows how to perform blocking write and read operations. </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/* Enable interfaces */</span></div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gace91592121b91b49a96b29e309a342bc">i2c_enable</a>(I2C_INST_M);</div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#gace91592121b91b49a96b29e309a342bc">i2c_enable</a>(I2C_INST_S);</div>
<div class="line">LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;I2C controller write blocking started\n&quot;</span>);</div>
<div class="line">ret = <a class="code hl_function" href="group__group__i2c__functions.html#ga1cb4ad53c8fd34aeb943efe1ddc19721">i2c_controller_write_blocking</a>(I2C_INST_M, &amp;config);</div>
<div class="line"><span class="keywordflow">if</span> (ret == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga6e3f0ba22df18c81e1d0962060940979aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>) {</div>
<div class="line">  LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller write success with status code:%d\n&quot;</span>, ret);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> {</div>
<div class="line">    LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller write failed with status code:%d\n&quot;</span>, ret);</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* Blocking Read */</span></div>
<div class="line">ret = <a class="code hl_function" href="group__group__i2c__functions.html#gaf5f0d3928229604eaa1ab381ed6f8faf">i2c_controller_read_blocking</a>(I2C_INST_M, &amp;read_config);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (ret == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga6e3f0ba22df18c81e1d0962060940979aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Blocking read success with status code: %d\n&quot;</span>, ret);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; read_config.size; i++) {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Read byte [%d]: 0x%02X\n&quot;</span>, i, read_config.buf[i]);</div>
<div class="line">        <span class="keywordflow">if</span> (read_config.buf[i] == target_tx_buf[i]) {</div>
<div class="line">            match_count++;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            mismatch_count++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> {</div>
<div class="line">    LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Blocking read failed with status code: %d\n&quot;</span>, ret);</div>
<div class="line">}</div>
<div class="line"> </div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_non_block"></a>
Non-Blocking Controller Write and Read</h2>
<p>This snippet shows how to perform non-blocking write and read operations. </p><div class="fragment"><div class="line">    <span class="comment">/*Non-Blocking Write */</span></div>
<div class="line">    LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller: Sending data...\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__group__i2c__functions.html#ga929619923229235b0bf639948b8bd681">i2c_controller_write_non_blocking</a>(I2C_INST_M, &amp;write_cfg) == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga6e3f0ba22df18c81e1d0962060940979aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line">        {</div>
<div class="line">            LOG_INFO(LOG_MOD_GENERIC,<span class="stringliteral">&quot;Write is completed\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        vTaskDelay(pdMS_TO_TICKS(10));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (xSemaphoreTake(i2c_controller_semaphore, pdMS_TO_TICKS(SEMAPHORE_TIMEOUT)) == pdTRUE) {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller semaphore taken!&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller semaphore TIMEOUT!&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (i2c_event_master_type == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga535fc726ccc82dfbb5fdb851449034f2a26729a83238356b5b3b373873045d866">I2C_EVENT_WRITE_COMPLETE</a> || i2c_event_master_type == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga535fc726ccc82dfbb5fdb851449034f2a87a646a98343056274ba13ccf619a9c3">I2C_EVENT_STOP_DET</a>) {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller: Write completed with event: 0x%X\n&quot;</span>,i2c_event_master_type);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller: Write failed. Event: 0x%X\n&quot;</span>, i2c_event_master_type);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/*Non-Blocking Read */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__i2c__functions.html#ga5c9d1d9c1671efeb077d79b674eab2eb">i2c_controller_read_non_blocking</a>(I2C_INST_M, &amp;read_non_block);</div>
<div class="line">    <span class="keywordflow">if</span> (xSemaphoreTake(i2c_controller_semaphore, pdMS_TO_TICKS(SEMAPHORE_TIMEOUT)) == pdTRUE) {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller semaphore taken!&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Controller semaphore TIMEOUT!&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (i2c_event_master_type == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga535fc726ccc82dfbb5fdb851449034f2acd17fdef932f82085d788370512f0513">I2C_EVENT_ABORT</a>) {</div>
<div class="line">        LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Non-Blocking read failed due to NACK/invalid address\n&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i2c_event_master_type == <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga535fc726ccc82dfbb5fdb851449034f2abce674c34f1aa7a3eed8bf62a9767e8b">I2C_EVENT_READ_COMPLETE</a>) {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Non-Blocking read success with event type: %d\n&quot;</span>, i2c_event_master_type);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; read_non_block.size; i++) {</div>
<div class="line">            LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Read byte [%d]: 0x%02X\n&quot;</span>, i, read_non_block.buf[i]);</div>
<div class="line">            <span class="keywordflow">if</span> (read_non_block.buf[i] == target_tx_buf[i]) {</div>
<div class="line">                match_count++;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                mismatch_count++;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Non-Blocking read with event type: %d\n&quot;</span>, i2c_event_master_type);</div>
<div class="line">    }</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_target_non_block"></a>
Non-Blocking Target Read</h2>
<p>This snippet shows how to perform non-blocking read operation. </p><div class="fragment"><div class="line">    LOG_INFO(LOG_MOD_GENERIC,<span class="stringliteral">&quot;Target: Reading Starts...\n&quot;</span>);</div>
<div class="line">    <span class="comment">/* Prepare to receive */</span></div>
<div class="line">    ret = <a class="code hl_function" href="group__group__i2c__functions.html#gae73fbf0d36d67dd67255e23bfb208d2b">i2c_target_prep_controller_write</a>(I2C_INST_S, target_rx_buf, <span class="keyword">sizeof</span>(target_rx_buf));</div>
<div class="line">    <span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga6e3f0ba22df18c81e1d0962060940979aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>) {</div>
<div class="line">        LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Target: Failed to prep controller write: %d&quot;</span>, ret);</div>
<div class="line">        vTaskDelete(NULL);</div>
<div class="line">    }</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_target_non_block"></a>
Non-Blocking Target Read</h2>
<p>This snippet shows how to perform non-blocking write operation. </p><div class="fragment"><div class="line"> ret = <a class="code hl_function" href="group__group__i2c__functions.html#gaa5350754e4fe5eb93eafd1543bd3ff37">i2c_target_prep_controller_read</a>(I2C_INST_S, target_tx_buf, <span class="keyword">sizeof</span>(target_tx_buf));</div>
<div class="line">    <span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__i2c__enums.html#gga6e3f0ba22df18c81e1d0962060940979aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>) {</div>
<div class="line">        LOG_ERROR(LOG_MOD_GENERIC, <span class="stringliteral">&quot;Target: Failed to prep controller read: %d&quot;</span>, ret);</div>
<div class="line">        vTaskDelete(NULL);</div>
<div class="line">    }</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_callback"></a>
Callback Handler</h2>
<p>This callback function is registered with the I2C driver and gets invoked asynchronously when an I2C event occurs. The function handles events such as transmission completion, reception, or error conditions. </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> i2c_event_cb(<a class="code hl_enumeration" href="group___i2_c___e_n_u_m_s.html#ga9ded102ddb09182140135eab907aac05">i2c_instance_en</a> <span class="keywordtype">id</span>, <a class="code hl_enumeration" href="group__group__i2c__enums.html#ga535fc726ccc82dfbb5fdb851449034f2">i2c_event_en</a> event_mask, <span class="keywordtype">void</span>* user_data)</div>
<div class="line">{</div>
<div class="line">    BaseType_t xHigherPriorityTaskWoken = pdFALSE;</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == I2C_INST_M) {</div>
<div class="line">        i2c_event_master_type = event_mask;</div>
<div class="line">        i2c_event_master_flag = 1;</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;[Controller] I2C Event: 0x%X\n&quot;</span>, event_mask);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (xPortIsInsideInterrupt()) {</div>
<div class="line">            xSemaphoreGiveFromISR(i2c_controller_semaphore, &amp;xHigherPriorityTaskWoken);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            xSemaphoreGive(i2c_controller_semaphore);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        i2c_event_type = event_mask;</div>
<div class="line">        i2c_event_flag = 1;</div>
<div class="line">        LOG_INFO(LOG_MOD_GENERIC, <span class="stringliteral">&quot;[Target] I2C Event: 0x%X\n&quot;</span>, event_mask);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (xPortIsInsideInterrupt()) {</div>
<div class="line">            xSemaphoreGiveFromISR(i2c_target_semaphore, &amp;xHigherPriorityTaskWoken);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            xSemaphoreGive(i2c_target_semaphore);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    portYIELD_FROM_ISR(xHigherPriorityTaskWoken);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="i2c_disable"></a>
I2C Disable</h2>
<p>This snippet disables the required I2C controllers and targets. </p><div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">/* Disable interfaces */</span></div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#ga9fb6bba7a3c26b9f5370148bbc871d8e">i2c_disable</a>(I2C_INST_M);</div>
<div class="line"><a class="code hl_function" href="group__group__i2c__functions.html#ga9fb6bba7a3c26b9f5370148bbc871d8e">i2c_disable</a>(I2C_INST_S);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>For complete register listings and detailed descriptions, refer to the Technical Reference Manual of your device. </dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
