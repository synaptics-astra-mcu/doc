<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Astra SRSDK Peripheral Driver Library: SDIO</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="syna_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Astra SRSDK Peripheral Driver Library
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__group__sdio__driver.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Topics</a>  </div>
  <div class="headertitle"><div class="title">SDIO<div class="ingroups"><a class="el" href="group__api__ref.html">Driver API Reference</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Topics</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sdio__macros.html">Macro Definitions</a></td></tr>
<tr class="memdesc:group__group__sdio__macros"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro Definitions for SDIO Driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sdio__enums.html">Enumerated Types</a></td></tr>
<tr class="memdesc:group__group__sdio__enums"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated Types for SDIO Driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sdio__type__definitions.html">Data Structures</a></td></tr>
<tr class="memdesc:group__group__sdio__type__definitions"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data Structures for SDIO Driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sdio__functions.html">Functions</a></td></tr>
<tr class="memdesc:group__group__sdio__functions"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions for SDIO Driver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Driver for SDIO peripheral</p>
<p>The SDIO driver provides functions to configure and control SDIO functionalities for communication with SD cards and I/O Devices. Features include:</p><ul>
<li>Command and data transfer initialization</li>
<li>Card status and information retrieval</li>
<li>Write protection control</li>
<li>Error handling and interrupt status</li>
</ul>
<h1><a class="anchor" id="group_sdio_configuration"></a>
Configuration Considerations</h1>
<p>To initialize and use the SDIO driver:</p><ul>
<li>Call <a class="el" href="group__group__sdio__functions.html#gaba89037bdff689b3c1177d2388d161dd">sdio_init</a> to initialize the SDIO host controller.</li>
<li>Use <a class="el" href="group__group__sdio__functions.html#ga22039631a3c6a8a5d40d60ee8b113a07">sdio_send_command</a> to send commands to the SD card.</li>
<li>Use <a class="el" href="group__group__sdio__functions.html#ga5c09fbd5a4f12c31019f13517ff5aaeb">sdio_init_data_transfer</a> for data read/write operations.</li>
</ul>
<h3><a class="anchor" id="PINMUX_CONFIG"></a>
SDIO Pinmux Configuration</h3>
<p>Configures the pin multiplexing for the SDIO interface to ensure proper routing of signals. </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__group__pinmux__general__functions.html#ga47a38dcfbefe690a36d46365c9a2ab71">pinmux_set_pin_function</a>(<a class="code hl_enumvalue" href="group___p_i_n_m_u_x___e_n_u_m_s.html#gga1e3f37e2bba6bf228285a8fe7c404040a1f9398d6309e63512e397a8175fab4bd">SD0_CMD</a>, SD0_CMD__SD0_CMD);</div>
<div class="line"><a class="code hl_function" href="group__group__pinmux__general__functions.html#ga47a38dcfbefe690a36d46365c9a2ab71">pinmux_set_pin_function</a>(<a class="code hl_enumvalue" href="group___p_i_n_m_u_x___e_n_u_m_s.html#gga1e3f37e2bba6bf228285a8fe7c404040aa7436f6e5d9bcab5f8ea7a67f91f050f">SD0_CLK</a>, SD0_CLK__SD0_CLK);</div>
<div class="line"><a class="code hl_function" href="group__group__pinmux__general__functions.html#ga47a38dcfbefe690a36d46365c9a2ab71">pinmux_set_pin_function</a>(<a class="code hl_enumvalue" href="group___p_i_n_m_u_x___e_n_u_m_s.html#gga1e3f37e2bba6bf228285a8fe7c404040a7397624e31a862639a420553a0e13a22">SD0_D0</a>, SD0_D0__SD0_D0);</div>
<div class="line"><a class="code hl_function" href="group__group__pinmux__general__functions.html#ga47a38dcfbefe690a36d46365c9a2ab71">pinmux_set_pin_function</a>(<a class="code hl_enumvalue" href="group___p_i_n_m_u_x___e_n_u_m_s.html#gga1e3f37e2bba6bf228285a8fe7c404040a902a6534b269cbfce17e15d63f34cd96">SD0_D1</a>, SD0_D1__SD0_D1);</div>
<div class="line"><a class="code hl_function" href="group__group__pinmux__general__functions.html#ga47a38dcfbefe690a36d46365c9a2ab71">pinmux_set_pin_function</a>(<a class="code hl_enumvalue" href="group___p_i_n_m_u_x___e_n_u_m_s.html#gga1e3f37e2bba6bf228285a8fe7c404040a7ee6693ed6f9fba06cfa9eb3bacd7200">SD0_D2</a>, SD0_D2__SD0_D2);</div>
<div class="line"><a class="code hl_function" href="group__group__pinmux__general__functions.html#ga47a38dcfbefe690a36d46365c9a2ab71">pinmux_set_pin_function</a>(<a class="code hl_enumvalue" href="group___p_i_n_m_u_x___e_n_u_m_s.html#gga1e3f37e2bba6bf228285a8fe7c404040ab02aa308d63fe2ac512ef7a50ccb6819">SD0_D3</a>, SD0_D3__SD0_D3);</div>
</div><!-- fragment --><h1><a class="anchor" id="group_sd_card"></a>
SD Card</h1>
<h3><a class="anchor" id="SDIO_INIT"></a>
SDIO Init Operation</h3>
<p>Initializes the SDIO module and prepares it for communication. </p><div class="fragment"><div class="line">ret = <a class="code hl_function" href="group__group__sdio__functions.html#gaba89037bdff689b3c1177d2388d161dd">sdio_init</a>(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a748c666a92d7c5032fd9b0b4918a280f">SDIO0</a>);</div>
<div class="line"><span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Failure!\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Success!\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_CONFIG"></a>
SDIO Host Configuration and Initialization.</h3>
<p>Sets up the host-side configuration, including DMA type and initializes the SDIO interface. </p><div class="fragment"><div class="line"><span class="keyword">const</span> <a class="code hl_struct" href="structsdio__config__t.html">sdio_config_t</a> sdHostConfig = {</div>
<div class="line">    .dmaType          = CONFIG_SDIO_HOST_DMA_TYPE,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="group__group__sdio__functions.html#ga4ff0d37ae45362fbcc54f1764caebb66">sdio_config</a>(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a748c666a92d7c5032fd9b0b4918a280f">SDIO0</a>, &amp;sdHostConfig);</div>
<div class="line"><span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Config Failure!\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Config Success!\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_SD_CARD_INIT"></a>
SDIO SD Card Configuration and Initialization.</h3>
<p>Initializes the SD card connected to the specified SDIO instance </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structsdio__sd__card__config__t.html">sdio_sd_card_config_t</a> sdCardConfig = {</div>
<div class="line"><span class="preprocessor">#ifdef CONFIG_SDIO_CARD__LOW_VOLTAGE_SIGNALING</span></div>
<div class="line">    .lowVoltageSignaling = <span class="keyword">true</span>,</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    .busWidth     = CONFIG_SDIO_CARD_BUS_WIDTH,</div>
<div class="line">    .cardType     = &amp;cardType,</div>
<div class="line">    .rca          = &amp;rca,</div>
<div class="line">    .cardCapacity = &amp;cardCapacity,</div>
<div class="line">    .clockSpeed   = CONFIG_SDIO_CLOCK,</div>
<div class="line">    .busSpeed     = CONFIG_SDIO_SDR50_SPEED,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Initialize the card */</span></div>
<div class="line">ret = <a class="code hl_function" href="group__group__sdio__functions.html#gaf206f72ee1025c36b51f5e6da1709155">sdio_sd_card_init</a>(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a748c666a92d7c5032fd9b0b4918a280f">SDIO0</a>, &amp;sdCardConfig );</div>
<div class="line"><span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Card Failure!\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Card Success!\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line">LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Complete! \n&quot;</span>);</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_WRITE_OPERATION"></a>
SDIO SD Card Write Operation.</h3>
<p>Writes a data block to the SD card using the SDIO interface. </p><div class="fragment"><div class="line"><span class="comment">/*Populate data*/</span></div>
<div class="line">int32_t i;</div>
<div class="line"><span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_define" href="group__group__sdio__macros.html#gae2b22da2fd3683faf7b150e3848d566e">SDIO_BLOCK_SIZE</a> ; i++) {</div>
<div class="line">    rxBuff[i] = 0x00;</div>
<div class="line">    txBuff[i] = (uint8_t)(rand());</div>
<div class="line">}</div>
<div class="line"><span class="comment">/*force TX buffer into memory*/</span></div>
<div class="line">cache_clean_addr((uint32_t*)&amp;txBuff[0], <a class="code hl_define" href="group__group__sdio__macros.html#gae2b22da2fd3683faf7b150e3848d566e">SDIO_BLOCK_SIZE</a>);</div>
<div class="line">data.data = (uint32_t*)txBuff;                  <span class="comment">/* The pointer to data to write. */</span></div>
<div class="line">ret = <a class="code hl_function" href="group__group__sdio__functions.html#gaee2ce601faeade870e8f2a1a4fad9332">sdio_sd_card_write</a>(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a748c666a92d7c5032fd9b0b4918a280f">SDIO0</a>,&amp;data);          <span class="comment">/* Write data to the card. */</span></div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_READ_OPERATION"></a>
SDIO SD Card Read Operation.</h3>
<p>Reads a data block from the SD card using the SDIO interface. </p><div class="fragment"><div class="line">data.data = (uint32_t*)rxBuff;                  <span class="comment">/* The pointer to data to read. */</span></div>
<div class="line">ret = <a class="code hl_function" href="group__group__sdio__functions.html#ga913708f9eb8b643d442b18faa6fcf409">sdio_sd_card_read</a>(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a748c666a92d7c5032fd9b0b4918a280f">SDIO0</a>, &amp;data);          <span class="comment">/* Read data from the card. */</span></div>
<div class="line"><span class="comment">/*force read buffer from memory*/</span></div>
<div class="line"><span class="keywordflow">if</span>(data.enableDma == <span class="keyword">false</span>) {</div>
<div class="line">    cache_clean_addr((uint32_t*)&amp;rxBuff[0], <a class="code hl_define" href="group__group__sdio__macros.html#gae2b22da2fd3683faf7b150e3848d566e">SDIO_BLOCK_SIZE</a>);</div>
<div class="line">}</div>
<div class="line">cache_invalidate_addr(CACHE_TYPE_DATA, (<span class="keywordtype">void</span> *)rxBuff, <a class="code hl_define" href="group__group__sdio__macros.html#gae2b22da2fd3683faf7b150e3848d566e">SDIO_BLOCK_SIZE</a>);</div>
</div><!-- fragment --><h1><a class="anchor" id="group_io_device"></a>
I/O Device</h1>
<h3><a class="anchor" id="SDIO_INIT_IO"></a>
SDIO Init Operation</h3>
<p>Initializes the SDIO module and prepares it for communication. </p><div class="fragment"><div class="line">ret = <a class="code hl_function" href="group__group__sdio__functions.html#gaba89037bdff689b3c1177d2388d161dd">sdio_init</a>(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a163ea6bf3192d4a6254b7e25bd3c1f98">SDIO1</a>);</div>
<div class="line"><span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Failure!\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Success!\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_HOST_INIT_TEST"></a>
SDIO Host Configuration and Initialization.</h3>
<p>Sets up the host-side configuration, including DMA type and initializes the SDIO interface. </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structsdio__config__t.html">sdio_config_t</a> sdHostConfig = {</div>
<div class="line">    .dmaType          = CONFIG_SDIO_HOST_DMA_TYPE,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">ret = sdio_host_init_test(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a163ea6bf3192d4a6254b7e25bd3c1f98">SDIO1</a>, &amp;sdHostConfig);</div>
<div class="line"><span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Config Failure!\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Config Success!\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_DEVICE_INIT_TEST"></a>
SDIO I/O Device Configuration and Initialization.</h3>
<p>Initializes the I/O Device connected to the specified SDIO instance </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structsdio__sd__card__config__t.html">sdio_sd_card_config_t</a> sdCardConfig = {</div>
<div class="line"><span class="preprocessor">#ifdef CONFIG_SDIO_CARD__LOW_VOLTAGE_SIGNALING</span></div>
<div class="line">    .lowVoltageSignaling = <span class="keyword">true</span>,</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    .busWidth     = CONFIG_SDIO_CARD_BUS_WIDTH,</div>
<div class="line">    .cardType     = &amp;cardType,</div>
<div class="line">    .rca          = &amp;rca,</div>
<div class="line">    .cardCapacity = &amp;cardCapacity,</div>
<div class="line">    .clockSpeed   = CONFIG_SDIO_CLOCK,</div>
<div class="line">    .busSpeed     = CONFIG_SDIO_SDR50_SPEED,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Initialize the IO Device */</span></div>
<div class="line">ret = sdio_device_init_test(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a163ea6bf3192d4a6254b7e25bd3c1f98">SDIO1</a>);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (ret != <a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a>) {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO IO Device Init Failure!\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO IO Device Init Success!\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line">LOG_INFO(LOG_MOD_SDIO,<span class="stringliteral">&quot;SDIO Init Complete! \n&quot;</span>);</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_CMD52_OPERATION"></a>
SDIO Direct I/O Transfer Operation (CMD52)</h3>
<p>Performs single-byte read/write to a specific register address in the I/O device. </p><div class="fragment"><div class="line">sdio_lock_test(sdio_mutex);</div>
<div class="line"><a class="code hl_enumeration" href="group__group__sdio__enums.html#ga5219916e992c3cf6741b897a5aef6f6e">sdio_status_en</a> ret = sdio_sd_cmd52_test(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a163ea6bf3192d4a6254b7e25bd3c1f98">SDIO1</a>, rw_flag, function_number, raw_flag, reg_addr, data);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a> == ret) {</div>
<div class="line">    <span class="keywordflow">if</span> (xSemaphoreTake(sdio_completion_sem, 5000) != pdPASS) {</div>
<div class="line">        LOG_ERROR(LOG_MOD_SDIO,<span class="stringliteral">&quot;Timeout waiting for CMD52 completion!\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    LOG_ERROR(LOG_MOD_SDIO, <span class="stringliteral">&quot;1st CMD52 failed!\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line">sdio_unlock_test(sdio_mutex);</div>
</div><!-- fragment --><h3><a class="anchor" id="SDIO_CMD53_OPERATION"></a>
SDIO Extended I/O Transfer Operation (CMD53)</h3>
<p>Performs multi-byte (or block) read or write transfer between the host and the I/O device. </p><div class="fragment"><div class="line">sdio_lock_test(sdio_mutex);</div>
<div class="line">sdio_sd_cmd53_test(<a class="code hl_enumvalue" href="group___s_d_i_o___e_n_u_m_s.html#ggaf3477c969e68259718bf72995d4bb223a163ea6bf3192d4a6254b7e25bd3c1f98">SDIO1</a>, read, funcNum, block_mode, opCode, reg_addr, byteCnt, globalBuffer);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="group__group__sdio__enums.html#gga5219916e992c3cf6741b897a5aef6f6eadbeb2d3757a517724dd2f5e97ae648a7">SDIO_OK</a> != ret) {</div>
<div class="line">    LOG_ERROR(LOG_MOD_SDIO, <span class="stringliteral">&quot;2nd CMD53 failed!\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line">sdio_unlock_test(sdio_mutex);</div>
</div><!-- fragment --><h2><a class="anchor" id="section11"></a>
Cache Handling for SDIO Operations</h2>
<h3><a class="anchor" id="section12"></a>
cache_clean_addr</h3>
<ul>
<li>Before an SD Card write operation, cache_clean_addr is called to ensure that any data modified in the CPU's cache for the transmit buffer is written back to main memory. This is crucial because the SDIO controller, when using DMA, reads directly from main memory, bypassing the CPU's cache. </li>
</ul>
<h3><a class="anchor" id="section13"></a>
cache_invalidate_addr</h3>
<ul>
<li>After an SD Card read operation, cache_invalidate_addr is called to invalidate the CPU's data cache entries for the receive buffer. This ensures that the CPU will read the newly updated data from main memory, as the SDIO controller (via DMA) writes directly to main memory, bypassing the CPU's cache.</li>
</ul>
<h3><a class="anchor" id="section14"></a>
Note:</h3>
<p>Incase SDIO DMA is enabled, do not place the read/write data buffers in the DTCM region as SDIO DMA does not have access to it. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
